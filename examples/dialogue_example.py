"""
Пример использования ai_mind2.py
Демонстрация всех улучшений
"""
import asyncio
import sys
import os

# Добавляем родительскую директорию в путь для импорта
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

# Примечание: для реального запуска нужен API ключ в .env
# Этот пример показывает структуру использования

async def example_dialogue():
    """Пример диалога с ботом"""
    print("="*60)
    print("ПРИМЕР ИСПОЛЬЗОВАНИЯ ai_mind2.py")
    print("="*60)

    print("\nПримечание: Для реального запуска требуется:")
    print("1. Создать файл .env с OPENAI_API_KEY")
    print("2. Установить зависимости: pip install openai python-dotenv")
    print("3. Убедиться что файл mind1.json существует")

    print("\n" + "="*60)
    print("СЦЕНАРИЙ ДИАЛОГА")
    print("="*60)

    dialogue = [
        ("Пользователь", "Ты опять ошибся", [
            "Ожидается активация: Тревога, Уточнение, Сожаление",
            "Распространение: Гнев, О былом, Условия причин",
            "Бот должен спросить: 'В чём именно ошибка?' или проявить беспокойство"
        ]),
        ("Пользователь", "Да, ты забыл про дедлайн", [
            "Усиление: Тревога, Сожаление, О былом",
            "Новые: Не надо было",
            "Давление растёт -> бот отвечает с извинениями"
        ]),
        ("Пользователь", "Ничего, бывает", [
            "Снижение: Тревога, Гнев",
            "Активация: Смирение, Благодарность",
            "Бот отвечает спокойнее, возможно благодарит"
        ]),
        ("Пользователь", "Как думаешь, стоит ли начать новый проект?", [
            "Активация: Уточнение, Сомнение, Сравнение",
            "Возможно: Выбор, Что если",
            "Бот задаёт уточняющие вопросы или размышляет"
        ])
    ]

    for i, (role, message, expected) in enumerate(dialogue, 1):
        print(f"\n{'='*60}")
        print(f"ШАГ {i}")
        print(f"{'='*60}")
        print(f"{role}: {message}")
        print(f"\nОжидаемое поведение:")
        for exp in expected:
            print(f"  • {exp}")

    print("\n" + "="*60)
    print("КАК ПРОВЕРИТЬ ЧТО УЛУЧШЕНИЯ РАБОТАЮТ")
    print("="*60)
    print("""
1. ПОЛНОЕ ДЕРЕВО СОСТОЯНИЙ:
   - Запустите ai_mind2.py
   - Проверьте логи: должны появляться состояния из всех уровней дерева
   - Не только корневые (Тревога, Сожаление), но и глубокие (Объективизация, Частота)

2. РАСПРОСТРАНЕНИЕ АКТИВАЦИИ:
   - При активации "Тревога" -> автоматически активируются "Гнев", "Сомнение"
   - Проверьте в логах: "Распространение активации, итераций: 3"

3. ЛОГИРОВАНИЕ:
   - Каждое действие должно записываться с timestamp
   - Используйте команду 'статус' для просмотра текущих состояний

4. ОТВЕТ СОГЛАСНО СОСТОЯНИЯМ:
   - Если активен Гнев -> ответ резкий
   - Если активно Уточнение -> ответ-вопрос
   - Если Сомнение -> неуверенность в ответе

5. СИСТЕМА ВЕСОВ:
   - Давление растёт при накоплении триггерных состояний
   - После ответа веса уменьшаются (особенно триггерные)
   - Проверьте: [Давление: X.XX] после каждого сообщения

6. БАЗА ЗНАНИЙ:
   - Файл world_model.json создаётся автоматически
   - Концепты извлекаются из диалогов
   - Проверьте: [Концептов: N] увеличивается
    """)

    print("\n" + "="*60)
    print("ЗАПУСК ЭКСПЕРИМЕНТОВ")
    print("="*60)
    print("""
Для тестирования без API:

1. Тест распространения активации:
   python experiments/test_state_propagation.py

2. Тест системы весов:
   python experiments/test_weight_system.py
    """)


if __name__ == "__main__":
    asyncio.run(example_dialogue())
